import javafx.application.Application;
import javafx.scene.Scene;
import javafx.scene.control.*;
import javafx.scene.layout.*;
import javafx.stage.Stage;
import ui.AdminUI;

public class MainApp extends Application {

    @Override
    public void start(Stage primaryStage) {
        // ===== LOGIN PAGE =====
        Label lblUser = new Label("Username:");
        Label lblPass = new Label("Password:");
        TextField txtUser = new TextField();
        PasswordField txtPass = new PasswordField();
        Button btnLogin = new Button("Login");
        Label lblMsg = new Label();

        GridPane loginPane = new GridPane();
        loginPane.setVgap(10);
        loginPane.setHgap(10);
        loginPane.setPadding(new Insets(20));
        loginPane.addRow(0, lblUser, txtUser);
        loginPane.addRow(1, lblPass, txtPass);
        loginPane.add(btnLogin, 1, 2);
        loginPane.add(lblMsg, 1, 3);

        Scene loginScene = new Scene(loginPane, 350, 200);
        primaryStage.setScene(loginScene);
        primaryStage.setTitle("Stock Management - Login");
        primaryStage.show();

        // ===== DASHBOARD =====
        BorderPane dashPane = new BorderPane();
        Label title = new Label("ðŸ“¦ Stock Management System Dashboard");
        title.setStyle("-fx-font-size: 18px; -fx-font-weight: bold;");
        TextArea infoArea = new TextArea();
        infoArea.setEditable(false);
        Button btnAdminPanel = new Button("Open Admin Panel");
        Button btnExit = new Button("Exit");

        VBox menu = new VBox(15, btnAdminPanel, btnExit);
        menu.setPadding(new Insets(20));
        dashPane.setTop(title);
        dashPane.setCenter(infoArea);
        dashPane.setRight(menu);

        Scene dashScene = new Scene(dashPane, 600, 400);

        // ===== LOGIN LOGIC =====
        btnLogin.setOnAction(e -> {
            String user = txtUser.getText();
            String pass = txtPass.getText();
            // Updated credentials
            if (user.equals("admin") && pass.equals("admin123")) {
                lblMsg.setText("âœ… Login successful!");
                primaryStage.setScene(dashScene);
                infoArea.setText("Welcome, " + user + "!\n\nUse the Admin Panel to manage products, suppliers, stock alerts, sales, and expiry dates.");
            } else {
                lblMsg.setText("âŒ Invalid credentials. Try again!");
            }
        });

        // ===== DASHBOARD BUTTON LOGIC =====
        btnAdminPanel.setOnAction(e -> {
            try {
                new AdminUI().show();
            } catch (Exception ex) {
                ex.printStackTrace();
            }
        });

        btnExit.setOnAction(e -> {
            primaryStage.close();
            System.out.println("System closed by user.");
        });
    }

    public static void main(String[] args) {
        launch(args);
    }
}
